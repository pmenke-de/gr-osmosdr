id: sdrplay_source
label: SDRplay Source
category: Sources

templates:
  imports: |-
    import osmosdr
  make: |
    osmosdr.source(args = $args + ",bias=" + str($bias) + ",lo=" + str($loFreq))
    self.$(id).set_sample_rate($sample_rate)
    self.$(id).set_center_freq($freq, 0)
    self.$(id).set_freq_corr($corr, 0)
    self.$(id).set_dc_offset_mode($dc_offset_mode, 0)
    self.$(id).set_iq_balance_mode($iq_balance_mode, 0)
    self.$(id).set_gain_mode($gain_mode, 0)
    self.$(id).set_gain($lna, "LNA_ATTEN_STEP", 0)
    self.$(id).set_gain($grdb, "IF_ATTEN_DB", 0)
    self.$(id).set_antenna($ant, 0)
    self.$(id).set_bandwidth($bw, 0)
  callbacks:
    - set_sample_rate($sample_rate)
    - set_center_freq($freq, 0)
    - set_freq_corr($corr, 0)
    - set_dc_offset_mode($dc_offset_mode, 0)
    - set_iq_balance_mode($iq_balance_mode, 0)
    - set_gain_mode($gain_mode, 0)
    - set_gain($lna, "LNA_ATTEN_STEP", 0)
    - set_gain($grdb, "IF_ATTEN_DB", 0)
    - set_antenna($ant, 0)
    - set_bandwidth($bw, 0)

parameters:
- id: type
  label: 'Output Type'
  dtype: enum
  options: [fc32]
  option_labels: [Complex Float32]
  option_attributes:
    type: [fc32]
- id: args
  label: 'Device Arguments'
  dtype: string
- id: nchan
  label: 'Num Channels'
  default: 1
  dtype: int
  options: [ 1 ]
- id: sample_rate
  label: 'Sample Rate (sps)'
  default: samp_rate
  dtype: real
- id: freq
  label: 'Frequency (Hz)'
  default: 100e6
  dtype: real
- id: corr
  label: 'Freq. Corr. (ppm)'
  default: 0
  dtype: real
- id: dc_offset_mode
  label: 'DC Offset Mode'
  default: 1
  dtype: int
  options: [0, 1]
  option_labels: [Off, Enabled]
- id: iq_balance_mode
  label: 'IQ Balance Mode'
  default: 1
  dtype: int
  options: [0, 1]
  option_labels: [Off, Enabled]
- id: gain_mode
  label: 'Gain Mode'
  default: False
  dtype: bool
  options: [False, True]
  option_labels: [Manual, Automatic]
- id: lna
  label: 'LNA Atten Step'
  default: 0
  dtype: real
- id: grdb
  label: 'IF Atten (dB)'
  default: 40
  dtype: real
- id: ant
  label: 'Antenna'
  default:
  dtype: string
  options: ['', RX, A, B, HIGHZ, T1_50ohm, T2_50ohm]
  option_labels: ['Default', 'RX', 'A (RSP2/RSP2pro)', 'B (RSP2/RSP2pro)', 'High Z (RSP2/RSP2pro/RSPduo)', 'Tuner 1 50 ohm (RSPduo)', 'Tuner 2 50 ohm (RSPduo)']
- id: bw
  label: 'Bandwidth (Hz)'
  default: 1536e3
  dtype: real
- id: bias
  label: 'Bias Voltage'
  default: 0
  dtype: int
  options: [0, 1]
  option_labels: [Off, On]
- id: loFreq
  label: 'AM LO Freq'
  default: 0
  dtype: int
  options: [0, 120, 144, 168]
  option_labels: [Auto, '120 MHz', '144 MHz', '168 MHz']
file_format: 1
